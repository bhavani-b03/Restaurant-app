<script>
document.addEventListener("DOMContentLoaded", function() {
    const filterBtn = document.getElementById("filterBtn");
    const filterDropdown = document.getElementById("filterDropdown");
    const priceBtn = document.getElementById("priceBtn");
    const priceDropdown = document.getElementById("priceDropdown");
    const applyPriceBtn = document.getElementById("applyPriceBtn");
    const minPriceInput = document.getElementById("startPrice");
    const maxPriceInput = document.getElementById("endPrice");
    const grid = document.querySelector(".grid");

    if (!filterBtn || !priceDropdown || !applyPriceBtn || !grid) return; // safety check

    // Toggle popup
    filterBtn.addEventListener("click", () => {
        filterDropdown.classList.toggle("hidden");
    });

    priceBtn.addEventListener("click", () => {
        priceDropdown.classList.toggle("hidden");
    });


    // Apply price filter
    applyPriceBtn.addEventListener("click", () => {
        const minPrice = minPriceInput.value;
        const maxPrice = maxPriceInput.value;

        // Example AJAX fetch to filter restaurants (adjust your URL)
        fetch("{% url 'restaurants:filter_by_price' %}", {
            method: "POST",
            headers: {
                "X-CSRFToken": "{{ csrf_token }}",
                "Content-Type": "application/x-www-form-urlencoded"
            },
            body: new URLSearchParams({ min_price: minPrice, max_price: maxPrice })
        })
        .then(res => res.json())
        .then(data => {
            grid.innerHTML = data.html; // replace restaurants grid
            initBookmarkButtons();
            priceDropdown.classList.add("hidden"); // hide popup

            
        })
        .catch(err => console.error(err));
    }); 
});
</script>
